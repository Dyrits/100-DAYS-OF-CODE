<%- include("../../includes/head", { title: "Cart", stylesheets: ["cart"], scripts: ["cart-update"] } ) %>
<%- include("../../includes/header") %>
<main>
    <h1>Cart</h1>
    <ul id="cart-items" class="list">
        <% for (const item of locals.cart.items) { %>
            <li><%- include("./includes/cart-item", { item }) %></li>
        <% } %>
    </ul>
    <div id="cart-total">
        <p>Total: $<span id="cart-total-price"><%= locals.cart.total.toFixed(2) %></span></p>
        <% if (locals.authenticated && locals.cart.quantity) { %>
            <form action="/orders" method="POST">
                <input type="hidden" value="<%= locals.csrf %>" name="_csrf">
                <button class="button">Purchase</button>
            </form>
        <% } else { %>
            <div id="cart-total-authentication">
                <% if (locals.cart.quantity) { %>
                    <p>Please <a href="/sign-in">sign-in</a> to purchase the items.</p>
                    <p><a href="/sign-up">Sign-up</a> if you don't have an account.</p>
                <% } else { %>
                    <p>Your cart is empty.</p>
                <% } %>
            </div>
        <% } %>
    </div>
</main>
<%- include("../../includes/footer") %>